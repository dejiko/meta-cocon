diff --git a/libfreerdp/core/license.c b/libfreerdp/core/license.c
index 3090b04..afdd624 100644
--- a/libfreerdp/core/license.c
+++ b/libfreerdp/core/license.c
@@ -205,6 +205,8 @@ boolean license_recv(rdpLicense* license, STREAM* s)
 	{
 		case LICENSE_REQUEST:
 			license_read_license_request_packet(license, s);
+			if(!license_read_license_request_packet(license, s))
+				return false;
 			license_send_new_license_request_packet(license);
 			break;
 
@@ -538,13 +540,16 @@ void license_free_binary_blob(LICENSE_BLOB* blob)
  * @param scopeList scope list
  */
 
-void license_read_scope_list(STREAM* s, SCOPE_LIST* scopeList)
+boolean license_read_scope_list(STREAM* s, SCOPE_LIST* scopeList)
 {
 	uint32 i;
 	uint32 scopeCount;
 
 	stream_read_uint32(s, scopeCount); /* ScopeCount (4 bytes) */
 
+	if (scopeCount > stream_get_length(s) / 4)  /* every blob is at least 4 bytes */
+		return false;
+
 	scopeList->count = scopeCount;
 	scopeList->array = (LICENSE_BLOB*) xmalloc(sizeof(LICENSE_BLOB) * scopeCount);
 
@@ -554,6 +559,7 @@ void license_read_scope_list(STREAM* s, SCOPE_LIST* scopeList)
 		scopeList->array[i].type = BB_SCOPE_BLOB;
 		license_read_binary_blob(s, &scopeList->array[i]);
 	}
+	return true;
 }
 
 /**
@@ -606,7 +612,7 @@ void license_free_scope_list(SCOPE_LIST* scopeList)
  * @param s stream
  */
 
-void license_read_license_request_packet(rdpLicense* license, STREAM* s)
+boolean license_read_license_request_packet(rdpLicense* license, STREAM* s)
 {
 	/* ServerRandom (32 bytes) */
 	stream_read(s, license->server_random, 32);
@@ -621,7 +627,8 @@ void license_read_license_request_packet(rdpLicense* license, STREAM* s)
 	license_read_binary_blob(s, license->server_certificate);
 
 	/* ScopeList */
-	license_read_scope_list(s, license->scope_list);
+	if(!license_read_scope_list(s, license->scope_list))
+		return false;
 
 	/* Parse Server Certificate */
 	certificate_read_server_certificate(license->certificate,
@@ -630,6 +637,7 @@ void license_read_license_request_packet(rdpLicense* license, STREAM* s)
 	license_generate_keys(license);
 	license_generate_hwid(license);
 	license_encrypt_premaster_secret(license);
+	return true;
 }
 
 /**
diff --git a/libfreerdp/core/license.h b/libfreerdp/core/license.h
index d3b998f..4c22372 100644
--- a/libfreerdp/core/license.h
+++ b/libfreerdp/core/license.h
@@ -177,9 +177,9 @@ void license_write_binary_blob(STREAM* s, LICENSE_BLOB* blob);
 
 SCOPE_LIST* license_new_scope_list();
 void license_free_scope_list(SCOPE_LIST* scopeList);
-void license_read_scope_list(STREAM* s, SCOPE_LIST* scopeList);
+boolean license_read_scope_list(STREAM* s, SCOPE_LIST* scopeList);
 
-void license_read_license_request_packet(rdpLicense* license, STREAM* s);
+boolean license_read_license_request_packet(rdpLicense* license, STREAM* s);
 void license_read_platform_challenge_packet(rdpLicense* license, STREAM* s);
 void license_read_new_license_packet(rdpLicense* license, STREAM* s);
 void license_read_upgrade_license_packet(rdpLicense* license, STREAM* s);
